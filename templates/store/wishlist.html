{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="min-h-[83vh] bg-gradient-to-br from-gray-50 via-white to-gray-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 py-4 sm:py-8 lg:py-12">
    {% include 'includes/alerts.html' %}
    <div class="container mx-auto px-3 sm:px-4 lg:px-6">

        {% if not wishlist_items %}
        <div class="max-w-lg sm:max-w-xl lg:max-w-2xl mx-auto text-center">
            <div class="bg-white dark:bg-gray-800 rounded-2xl sm:rounded-3xl shadow-xl p-6 sm:p-8 md:p-12 lg:p-16 border border-gray-100 dark:border-gray-700">
                <div class="w-16 h-16 sm:w-20 sm:h-20 lg:w-24 lg:h-24 mx-auto mb-4 sm:mb-6 bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-800 dark:to-blue-900 rounded-full flex items-center justify-center">
                    <svg class="w-8 h-8 sm:w-10 sm:h-10 lg:w-12 lg:h-12 text-blue-500 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                    </svg>
                </div>
                <h2 class="text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl font-semibold text-gray-900 dark:text-gray-100">Your wishlist is empty</h2>
                <a href="{% url 'store' %}" class="inline-block mt-4 sm:mt-6 bg-gradient-to-r from-blue-600 to-blue-700 text-white py-2 sm:py-2 md:py-3 px-4 sm:px-4 md:px-6 rounded-full text-sm sm:text-base md:text-lg lg:text-xl font-semibold hover:from-blue-700 hover:to-blue-800 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl">
                    Browse Products
                </a>
            </div>
        </div>
        {% else %}

        <!-- Layout container -->
        <div class="flex flex-col md:flex-col lg:flex-row gap-3 sm:gap-4 lg:gap-6">

            <!-- Wishlist table / main content -->
            <div class="flex-1 order-2 lg:order-1 lg:w-2/3">
                <div class="bg-white dark:bg-gray-800 rounded-xl sm:rounded-2xl shadow-xl overflow-hidden border border-gray-100 dark:border-gray-700">
                    <!-- Table Header -->
                    <div class="hidden sm:block bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200 dark:border-gray-600">
                        <div class="grid grid-cols-12 gap-4 text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                            <div class="col-span-6">Product</div>
                            <div class="col-span-3">Price</div>
                            <div class="col-span-3 text-right">Actions</div>
                        </div>
                    </div>

                    <!-- Items -->
                    <div class="divide-y divide-gray-100 dark:divide-gray-600">
                        {% for item in wishlist_items %}
                        <div class="p-3 sm:p-4 lg:p-6 hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-200 group">
                            <div class="grid grid-cols-12 gap-3 sm:gap-4 items-center">
                                
                                <!-- Product -->
                                <div class="col-span-12 sm:col-span-6">
                                    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3">
                                        <img src="{{ item.product.images.url }}" 
                                             class="w-10 h-10 sm:w-12 sm:h-12 lg:w-16 lg:h-16 object-cover rounded-lg sm:rounded-xl shadow-md group-hover:shadow-lg transition-shadow duration-200" 
                                             alt="{{ item.product.product_name }}">
                                        <div class="flex-1 min-w-0">
                                            <a href="{{ item.product.get_url }}" 
                                               class="font-medium text-gray-900 dark:text-gray-100 hover:text-blue-500 dark:hover:text-blue-400 block transition-colors duration-200 text-sm sm:text-sm md:text-base lg:text-base">
                                                {{ item.product.product_name }}
                                            </a>
                                            {% if item.variations.all %}
                                            <p class="text-gray-500 dark:text-gray-400 text-xs sm:text-sm mt-1">
                                                {% for var in item.variations.all %}
                                                {{ var.variation_category|capfirst }}: {{ var.variation_value|capfirst }}<br>
                                                {% endfor %}
                                            </p>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>

                                <!-- Price -->
                                <div class="col-span-6 sm:col-span-3 mt-1 sm:mt-0">
                                    <span class="font-medium text-sm sm:text-sm md:text-base lg:text-base text-gray-900 dark:text-gray-100">Tk {{ item.product.price }}</span>
                                </div>

                                <!-- Actions -->
                                <div class="col-span-6 sm:col-span-3 mt-1 sm:mt-0">
                                    <div class="flex flex-col sm:flex-row gap-1 sm:gap-2 justify-start sm:justify-end">
                                        <!-- Move to Cart -->
                                        <form action="{% url 'move_to_cart' item.id %}" method="POST" class="w-full sm:w-auto">
                                            {% csrf_token %}
                                            {% for var in item.variations.all %}
                                            <input type="hidden" name="{{ var.variation_category|lower }}" value="{{ var.variation_value }}">
                                            {% endfor %}
                                            <button class="bg-gradient-to-r from-green-600 to-green-700 text-white px-2 sm:px-2 md:px-3 py-1 sm:py-1 md:py-2 rounded-md sm:rounded-lg font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 w-full sm:w-auto text-xs sm:text-sm md:text-base lg:text-base whitespace-nowrap focus:outline-2 focus:outline-green-500 focus:outline-offset-2">
                                                Move to Cart
                                            </button>
                                        </form>

                                        <!-- Remove -->
                                        <form action="{% url 'remove_from_wishlist' item.id %}" method="POST" class="w-full sm:w-auto">
                                            {% csrf_token %}
                                            {% for var in item.variations.all %}
                                            <input type="hidden" name="{{ var.variation_category|lower }}" value="{{ var.variation_value }}">
                                            {% endfor %}
                                            <button type="submit" onclick="return confirm('Are you sure you want to delete this item?')" class="bg-white dark:bg-gray-800 border-2 border-red-200 dark:border-red-700 text-red-600 dark:text-red-400 px-2 sm:px-2 md:px-3 py-1 sm:py-1 md:py-2 rounded-md sm:rounded-lg font-semibold hover:bg-red-50 dark:hover:bg-red-900/20 hover:border-red-300 dark:hover:border-red-600 transition-all duration-200 w-full sm:w-auto text-xs sm:text-sm md:text-base lg:text-base whitespace-nowrap focus:outline-2 focus:outline-red-500 focus:outline-offset-2">
                                                Remove
                                            </button>
                                        </form>
                                    </div>
                                </div>

                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <aside class="w-full lg:w-1/3 order-1 lg:order-2">
                <div class="bg-white dark:bg-gray-800 rounded-xl sm:rounded-2xl shadow-xl p-4 sm:p-6 md:p-8 border border-gray-100 dark:border-gray-700 space-y-3 sm:space-y-4">
                    <div class="w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-800 dark:to-blue-900 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 sm:w-8 sm:h-8 text-blue-600 dark:text-blue-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h3 class="font-bold text-base sm:text-lg md:text-xl lg:text-2xl text-gray-900 dark:text-gray-100 text-center">Your Wishlist</h3>
                    <p class="text-gray-600 dark:text-gray-400 text-xs sm:text-sm md:text-base lg:text-base text-center">Items you've saved for later. Move them to your cart when ready.</p>
                    <a href="{% url 'store' %}" class="block w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-2 sm:py-2 md:py-3 px-3 sm:px-4 md:px-6 rounded-full text-center font-semibold hover:from-blue-700 hover:to-blue-800 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl text-xs sm:text-sm md:text-base lg:text-base focus:outline-2 focus:outline-blue-500 focus:outline-offset-2">
                        Continue Shopping
                    </a>
                </div>
            </aside>

        </div>
        {% endif %}

    </div>
</section>
{% endblock %}