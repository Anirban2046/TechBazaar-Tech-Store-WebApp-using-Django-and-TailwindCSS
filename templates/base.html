{% load static %}
<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache" />
  <meta http-equiv="cache-control" content="max-age=604800" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>TechBazaar | Your Trusted Online Shopping Platform for Electronic Gadgets</title>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Feather icons CDN -->
  <script src="https://unpkg.com/feather-icons"></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400&display=swap" rel="stylesheet">


  <script type="text/javascript">
    $(document).ready(function() {
      // Example: Thumbnail image swap
      $(document).on('click', '.thumb a', function(e){
        e.preventDefault();
        var newSrc = $(this).data('src') || $(this).attr('href');
        $('.mainImage img').attr('src', newSrc);
      });
    });
  </script>
</head>
<body>

  <!-- navbar -->
  {% include 'includes/navbar.html' %}

  {% block content %}
  <!-- page content -->
  {% endblock %}

   <!-- footer -->
   {% include 'includes/footer.html' %}



<!-- Chatbot Begin -->

<!-- Floating Chatbot Button -->
<div id="chatbot" style="
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: linear-gradient(135deg, #17a2b8, #138496);
    box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 9999;
    transition: transform 0.2s ease;
">
    <i id="chatbot-icon" class="fa fa-comments" style="color: #fff; font-size: 28px;"></i>
</div>

<!-- Chatbot Panel -->
<div id="chatbot-panel" style="
    position: fixed;
    bottom: 100px;
    right: 20px;
    width: 360px;
    max-height: 500px;
    border-radius: 15px;
    background: #fff;
    box-shadow: 0 12px 25px rgba(0,0,0,0.3);
    display: none;
    flex-direction: column;
    overflow: hidden;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    z-index: 9999;
">

    <!-- Header -->
    <div style="
        background: linear-gradient(135deg, #17a2b8, #138496);
        color: #fff;
        padding: 12px 15px;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 16px;
    ">
        TechBazaar Help
        <div>
            <!-- Back to root icon -->
            <i id="chatbot-back" class="fa fa-arrow-left" style="
                cursor: pointer;
                margin-right: 12px; /* spacing between icons */
                font-size: 16px;
            " title="Back to root"></i>

            <!-- Clear chat icon -->
            <i id="chatbot-clear" class="fa fa-broom" style="
                cursor: pointer;
                font-size: 16px;
            " title="Clear chat"></i>
        </div>
    </div>

    <!-- Options -->
    <div id="chatbot-options" style="
        flex: 1;
        padding: 12px;
        overflow-y: auto;
        background: #f9f9f9;
        font-size: 14px;
    "></div>

    <!-- Messages -->
    <div id="chatbot-messages" style="
        padding: 12px;
        font-size: 14px;
        border-top: 1px solid #ddd;
        max-height: 180px;
        overflow-y: auto;
        background: #fff;
        display: flex;
        flex-direction: column;
        gap: 8px;
    "></div>
</div>

<!-- Chatbot Script -->
<script>
    const chatbot = document.getElementById('chatbot');
    const panel = document.getElementById('chatbot-panel');
    const messages = document.getElementById('chatbot-messages');
    const options = document.getElementById('chatbot-options');
    const clearBtn = document.getElementById('chatbot-clear');
    const backBtn = document.getElementById('chatbot-back');

    // Floating button animation
    chatbot.addEventListener('mouseenter', () => chatbot.style.transform = 'scale(1.1)');
    chatbot.addEventListener('mouseleave', () => chatbot.style.transform = 'scale(1)');

    // Toggle chatbot panel
    chatbot.addEventListener('click', () => {
        panel.style.display = panel.style.display === 'flex' ? 'none' : 'flex';
        if(panel.style.display === 'flex') renderOptions(faqTree);
    });

    // Clear chat
    clearBtn.addEventListener('click', () => {
        messages.innerHTML = '';
    });

    // Back to root
    backBtn.addEventListener('click', () => {
        renderOptions(faqTree);
    });

    // FAQ data
    const faqTree = [
        {
            question: "Shipping & Delivery",
            children: [
                { question: "What are your shipping charges?", answer: "Shipping is free for orders over Tk 5000. Otherwise Tk 150." },
                { question: "How long does delivery take?", answer: "Delivery usually takes 2-5 business days within Bangladesh." },
                { question: "Do you ship internationally?", answer: "Currently, we only ship within Bangladesh." },
                { question: "Can I change my shipping address?", answer: "Yes, before the order is dispatched, contact support to change the address." }
            ]
        },
        {
            question: "Warranty & Returns",
            children: [
                { question: "Do you provide warranty?", answer: "Yes, all products come with manufacturer warranty." },
                { question: "How can I return an item?", answer: "You can return items within 7 days of delivery. Contact support to start the process." },
                { question: "What if my product is damaged?", answer: "Contact support immediately, and we will assist with replacement or refund." }
            ]
        },
        {
            question: "Orders & Support",
            children: [
                { question: "Can I cancel my order?", answer: "Yes, cancel before shipment. Contact support to cancel." },
                { question: "Can I modify my order?", answer: "Only before dispatch. Contact support for changes." },
                { question: "What if I receive a wrong product?", answer: "Contact support immediately for a replacement or refund." }
            ]
        },
        {
            question: "Payments",
            children: [
                { question: "What payment methods do you accept?", answer: "We accept bKash, Rocket, Nagad, Upay, VisaCard, MasterCard and DBBL Nexus Card." },
                { question: "Is online payment secure?", answer: "Yes, all payments are encrypted and secure." },
                { question: "Can I pay on delivery?", answer: "Currently, Cash on Delivery is not available; please use online payment methods." }
            ]
        },
        {
            question: "Products",
            children: [
                { question: "Do you have smartphones?", answer: "Yes, all popular brands and models are available." },
                { question: "Do you sell laptops?", answer: "Yes, laptops from multiple brands are available." },
                { question: "Do you sell accessories?", answer: "Yes, keyboards, mice, headphones, speakers, tablets, and more." },
                { question: "Are your products genuine?", answer: "Yes, we sell only genuine, brand new products." }
            ]
        }
    ];

    // Render option buttons
    function renderOptions(tree) {
        options.innerHTML = '';
        tree.forEach(item => {
            const btn = document.createElement('button');
            btn.textContent = item.question;
            btn.style.cssText = `
                width:100%;
                margin-bottom:6px;
                padding:10px;
                border:none;
                border-radius:8px;
                background:#fff;
                cursor:pointer;
                text-align:left;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                transition: background 0.2s, transform 0.1s;
            `;
            btn.onmouseover = () => { btn.style.background='#f1f9ff'; btn.style.transform='translateX(3px)'; }
            btn.onmouseout = () => { btn.style.background='#fff'; btn.style.transform='translateX(0)'; }
            btn.addEventListener('click', () => handleClick(item));
            options.appendChild(btn);
        });
    }

    // Handle Q&A with chat bubble styling
    function handleClick(node) {
        if(node.answer) {
            // User message (right side bubble)
            messages.innerHTML += `
                <div style="text-align: right;">
                    <span style="
                        display: inline-block;
                        background: #17a2b8;
                        color: #fff;
                        padding: 8px 12px;
                        border-radius: 15px 15px 0 15px;
                        max-width: 80%;
                        text-align: left;
                        margin-bottom: 6px;
                    ">${node.question}</span>
                </div>
            `;
            messages.scrollTop = messages.scrollHeight;

            // Bot reply after delay (left side bubble)
            setTimeout(() => {
                messages.innerHTML += `
                    <div style="text-align: left;">
                        <span style="
                            display: inline-block;
                            background: #f1f0f0;
                            color: #000;
                            padding: 8px 12px;
                            border-radius: 15px 15px 15px 0;
                            max-width: 80%;
                            text-align: left;
                            margin-bottom: 6px;
                        ">${node.answer}</span>
                    </div>
                `;
                messages.scrollTop = messages.scrollHeight;
            }, 800);
        }
        if(node.children) renderOptions(node.children);
    }
</script>


<!-- Chatbot End -->

</body>
</html>
